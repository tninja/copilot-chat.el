
* Function call dependencies

#+BEGIN_SRC plantuml :file dependencies.png
@startuml
' 使用正确的类图语法
skinparam class {
    BackgroundColor White
    ArrowColor Black
    BorderColor Black
}

' 定义节点类型
class copilot-chat--write-buffer
class copilot-chat--format-data
class "copilot-chat-prompt-send" as prompt_send
class copilot-chat--ready-p
class copilot-chat--create-req
class copilot-chat--ask
class copilot-chat--uuid
class copilot-chat--machine-id
class copilot-chat--auth
class copilot-chat--login
class copilot-chat--renew-token
class copilot-chat--curl-login
class copilot-chat--curl-renew-token
class copilot-chat--request-login
class copilot-chat--request-renew-token
class copilot-chat--curl-ask
class copilot-chat--request-ask
class copilot-chat--create
class copilot-chat--get-cached-token

' 添加关系
prompt_send --> copilot-chat--ready-p
prompt_send --> copilot-chat-reset
prompt_send --> copilot-chat--write-buffer
prompt_send --> copilot-chat--format-data
prompt_send --> copilot-chat--ask

copilot-chat--create-req --> copilot-chat-history
copilot-chat--create-req --> copilot-chat-buffers

copilot-chat--ask --> copilot-chat-history
copilot-chat--ask --> copilot-chat--auth
copilot-chat--ask --> copilot-chat--curl-ask
copilot-chat--ask --> copilot-chat--request-ask

copilot-chat--create --> copilot-chat--get-cached-token
copilot-chat--create --> copilot-chat--uuid
copilot-chat--create --> copilot-chat--machine-id

copilot-chat--login --> copilot-chat--curl-login
copilot-chat--login --> copilot-chat--request-login

copilot-chat--renew-token --> copilot-chat--curl-renew-token
copilot-chat--renew-token --> copilot-chat--request-renew-token

copilot-chat--auth --> copilot-chat--login
copilot-chat--auth --> copilot-chat--renew-token

' Shell Maker 相关
class "copilot-chat--shell-maker-custom-prompt-selection" as shell_prompt_selection
class copilot-chat--shell-maker-insert-and-send-prompt
class "copilot-chat--shell-maker-display" as shell_maker_display
class copilot-chat--shell-maker-copy-faces
class copilot-chat--shell-cb-prompt
class copilot-chat--shell-cb
class copilot-chat--shell
class copilot-chat-shell-maker-init

shell_prompt_selection --> copilot-chat-reset
shell_prompt_selection --> copilot-chat--shell-maker-insert-and-send-prompt

shell_maker_display --> copilot-chat-reset
shell_maker_display --> copilot-chat--shell-maker-prepare-buffers

copilot-chat--shell-cb --> copilot-chat--shell-cb-prompt
copilot-chat--shell-cb --> copilot-chat--ask

copilot-chat--shell --> shell-maker-start
copilot-chat-shell-maker-init --> copilot-chat--shell-maker-clean

@enduml
#+END_SRC

#+RESULTS:
[[file:dependencies.png]]
